# Sandy v.0.1 ビルドガイド

このドキュメントは、Sandy v.0.1を組み立てるためのビルドガイドです。  
Sandyのコンセプトや特徴、ビルド例などについては、こちらの[README](/README.md)をご覧ください。

ビルドガイド全体に目を通して作業手順を把握しておくとミスの防止につながりますので、ぜひ、一度お読みになってから組み立て作業を始めてください。

作業手順をしっかりと確認しながら組み立てたい方は、

<details>
<summary>《《《 詳しい説明 》》》</summary>

ここに追加の説明を表示します。
</details>

と書かれたところをクリックすると、追加の説明が表示されます。

---

## 目次

<!-- @import "[TOC]" {cmd="toc" depthFrom=2 depthTo=3 orderedList=false} -->

<!-- code_chunk_output -->

- [目次](#目次)
- [注意事項、制限など](#注意事項-制限など)
- [仕様](#仕様)
- [部品リスト](#部品リスト)
  - [キット内容](#キット内容)
  - [別途用意が必要な部品](#別途用意が必要な部品)
  - [オプション部品](#オプション部品)
- [組み立て前の確認](#組み立て前の確認)
- [組み立てに使用する工具](#組み立てに使用する工具)
- [組み立て手順](#組み立て手順)
  - [組み立てるレイアウトを決める](#組み立てるレイアウトを決める)
  - [基板Topの準備](#基板topの準備)
  - [基板Midの準備](#基板midの準備)
  - [基板Baseの準備](#基板baseの準備)
  - [各基板をひとつに組み合わせる](#各基板をひとつに組み合わせる)
  - [動作確認と基板の完全固定](#動作確認と基板の完全固定)
  - [ケースへ取り付け](#ケースへ取り付け)
- [サービスマニュアル](#サービスマニュアル)

<!-- /code_chunk_output -->

---

## 注意事項、制限など

- 試作版

  Sandy v.0.1は試作版です。  
  とりあえずの動作確認はできていますが、何が起きるかわかりません。

- スイッチの取り付け

  - 一部のスイッチは、上下逆向きに取り付けます。

  - ソケットを使用せず、基板に直接はんだ付けして取り付けます。

- GH60型，Poker型のケースへの取り付け

  - 中央、中央下のネジを使用せず、左右4本のネジだけで取り付けます。

  - ケース内部の構造などによっては、取り付けが難しかったり取り付けできない場合があるかもしれません。

    取り付けの確認ができしだい、確認済みリストを随時更新していく予定です。

- 5方向スイッチ（JS5208）の取り付け

  固定足のうち1本をニッパーなどでカットして取り付けます。

## 仕様

〓基板間隔の設定範囲とか（書きかけ）

基板間隔

Base → Mid

最小 2.0mm（ナット1.6mm + ワッシャー0.4mm） ※薄いワッシャーを使って、1.8mmくらいまでならなんとか

## 部品リスト

このキットを組み立てるためには、[キット内容](#キット内容)に加え、[別途用意が必要な部品](#別途用意が必要な部品)が必要です。  
好みに合わせて、必要な数をお買い求めください。

[オプション部品](#オプション部品)は、使いたい機能などに応じて用意してください。  

### キット内容

| 部品名 | 個数 | 備考 |
| :-- | --: | :-- |
| ご案内リーフレット | 1 | |
| 基板 Base | 1 | Baseのみ部品実装済み |
| 基板 Mid | 1 | |
| 基板 Top | 1 | |
| ダイオード<br>表面実装（SMD）タイプ, 1N4148W | 30 | 予備3個含む<br>[高速スイッチング・ダイオード　１Ｎ４１４８Ｗ](https://akizukidenshi.com/catalog/g/gI-07084/) |
| コネクタ<br>JST SH ベース サイド型 4pin 面実装 | 12 | 互換品<br>[HR(Joint Tech Elec) A1001WR-S-04P](https://www.lcsc.com/product-detail/_HR-Joint-Tech-Elec-_C371510.html) |
| スペーサー<br>丸型または六角 両メネジ, M2 3mm | 8 | [ヒロスギ ARB-2003E](https://hirosugi.co.jp/products/B/ARB-E.html#bx3)など |
| 六角ナット<br>M2 2種 | 22 | [ウィルコ FNT-02N-2](https://wilco.jp/products/F/FNT-N-2.html)など |
| ワッシャー<br>内径2.3mm 外径4.3mm 厚さ0.4mm | 11 | [ウィルコ FW-0204-04N](https://wilco.jp/products/F/FW-N.html#page3)など |
| ネジ<br>M2 3mm | 16 | |
| ネジ<br>M2 4mm | 4 | |
| ネジ<br>M2 7mm | 11 | |
| PCBマウント スタビライザー<br>2uサイズ | 3 | 組み立てるレイアウトにより使用数が変わります |
| LED<br>SK6812MINI | 4 | インジケータLEDを使用する場合のみ取り付けます<br>[マイコン内蔵ＲＧＢＬＥＤ　ＳＫ６８１２ＭＩＮＩ](https://akizukidenshi.com/catalog/g/gI-15477/) |

※出荷時期によって、基板等の仕様や、部品のメーカーや品番などを変更することがあります。

### 別途用意が必要な部品

| 部品名 | 個数 | 備考 |
| :-- | :-- | :-- |
| Qwiicケーブル, JST SH 4pin | 6 | - [Qwiicケーブル（Qwiic -Qwiic）50 mm](https://www.switch-science.com/products/6896?_pos=1&_sid=bc641ada5&_ss=r)<br>- [コネクタ付コード　４Ｐ　黒赤青黄　両端コネクタ付き](https://akizukidenshi.com/catalog/g/gC-15884/) <br>組み立て時にケーブルを逃すのが大変なので、5cmより長いものはおすすめしません。|
| MXスイッチ | 67 〜 71 | 組み立てるレイアウトにより使用数が変動します。<br>スイッチの端子折れや不良品、故障した場合などに備えて、いくつか予備があると安心です。<br>取り付け安定性の高い5pinタイプが推奨ですが、傾かないように気をつければ3pinでも問題ありません。 |
| キーキャップ<br>MXスイッチ用 | 必要数 | 一般的な英語104のキーキャップセットで一通り埋めることができます。<br>1.5uエンターや1.5uバックスペースがあると雰囲気が良くなります。<br>2uや1.5uのスペースは、DSAなどを使用するのも良いでしょう。 |
| GH60型, Poker型ケース<br>または<br>Jones／Nora用ボトムプレートキット | 1 | |
| USBケーブル （Type-C） | 1 | |

### オプション部品

| 部品名 | 個数 | 備考 |
| :-- | :-- | :-- |
| ロータリーエンコーダ, ALPS EC11, EC12または同等品 | 最大 2 | プッシュスイッチ付きにも対応 |
| ロータリーエンコーダ用ノブ（つまみ） | 必要数 | |
| 5方向スイッチ, [JS5208](https://www.lcsc.com/product-detail/_E-Switch-_C3029619.html) | 1 | |
| 5方向スイッチ用ノブ（つまみ） | 必要数 | 3.3mm角の軸に対応する、[タクトスイッチキャップ（10個入） [PLSA11CP]](https://www.aitendo.com/product/9731)など。<br>旧機種向けの*ロープロファイルではない*トラックポイント・キャップも、まぁまぁ使えます。 |
| PCBマウント スタビライザー, 2uサイズ | 最大3 | キット内容よりも高品位なものを使用する場合。 |

## 組み立て前の確認

1. Base基板を、USBケーブルでPCやMacに接続します。

1. PCやMacで認識されていることを確認します。  

    - 例：Windows  
      設定 → キーボードに、”Sandy”が表示されていること

    - 例：Mac  
      システムレポート → USBに、”Sandy”が表示されていること

1. Remapを開いて、キーボード”Sandy”を接続します。

1. Remapの”Test Matrix Mode”を開きます。

1. Base基板のスイッチ取り付け穴をピンセットなどでショートさせ、画面上のキーの色が青に変わることを確認します。

確認作業に問題がある場合は @jpskenn へ連絡してください。

## 組み立てに使用する工具

- 必要な工具

  - 先の細いプラスドライバー（M2ネジに対応するもの。+0）

  - はんだ付け関連用品

  - ピンセット

- あると便利な工具

  - ラジオペンチ、またはM2ナット対応の十字レンチなど

    ナットを締めるのが楽になります。  
    [タミヤ SP.38 工具セット](https://www.tamiya.com/japan/products/50038/index.html)の十字レンチがM2ナットに対応しています。

  - フラックスやハンダ吸い取り線

    はんだ付けの、ちょっとした修正や部品の取り外しなどがしやすくなります。

  - テスター

    はんだ付けの難易度が少し高くミスが起こりがちなので、何か不具合があった場合の原因調査で活躍します。

## 組み立て手順

以降の手順に沿って組み立てます。  
`（オプション）`の手順は、不要であれば作業をとばしてもかまいせん。  
`（該当者のみ）`の手順は、条件に該当する場合のみ作業をおこないます。

### 組み立てるレイアウトを決める

以下のポイントを念頭に、組み立てるレイアウトを決めます。

- キーのサイズ
- ロータリーエンコーダの有無と場所
- 5方向スイッチの有無

参考： [Sandyのレイアウト](http://www.keyboard-layout-editor.com/#/gists/1d0f4082c7ae670692987e3519c82648)

### 基板Topの準備

1. 基板側面をマジックで塗る

1. コネクタを取り付ける（3個）

    うら側

1. ダイオードを取り付ける（19個）

    うら側

1. スイッチを取り付ける

    おもて側からはめ込んで、うら側からはんだ付けします。

1. 基板Topのコネクタへ、ケーブルを差し込む（3本）。

### 基板Midの準備

1. 基板側面をマジックで塗る

1. （該当者のみ）LEDディフューザーのタブを切り取る。

    *基板Baseと基板Midの間へ3.4mm以上のスペーサーを取り付ける場合。*

    LEDディフューザーとキーキャップが干渉しないよう、基板からLEDディフューザーのタブを切り取ります。  
    手でパキッと折ったりニッパーを使ったりして切り取り、切り取った箇所をやすりなどで滑らかにします。

1. コネクタを取り付ける（3個）

    うら側

1. ダイオードを取り付ける（18個）

    うら側

1. （オプション）5方向スイッチを取り付ける

    5方向スイッチの小さい足のうち1本を切り取ります。（はめ込んでみて当たるところ）  
    おもて側からはめ込んで、うら側からはんだ付けします。

1. スイッチを取り付ける

    おもて側からはめ込んで、うら側からはんだ付けします。  
    組み立てるレイアウトにより、一部の取り付け位置が変わります。

1. 基板Midのおもて側から、ワッシャーを挟んだナットを7mmネジでとめる（11箇所）。

    7mmネジ  
    ↓  
    基板Mid  
    ↓  
    ワッシャー  
    ↓  
    ナット

1. 基板Midのうら側から、スペーサーを3mmネジでとめる（8箇所）。

    スペーサー  
    ↑  
    基板Mid  
    ↑  
    3mmネジ

1. 基板Midのコネクタへ、ケーブルを差し込む（3本）。

    差し込んだ後、次の作業がしやすいように、Mid基板の穴からおもて側へ出しておきます。

### 基板Baseの準備

1. 基板側面をマジックで塗る

1. （オプション）インジケータLEDを取り付ける

    おもて側へ、以下のいずれかの組み合わせでLEDを取り付けます。  

    - 左 2個，右なし
    - 左なし，右 2個
    - 左 2個， 右 2個

    うら側のLeft LEDsとRight LEDsを、LEDを取り付けた場合はON、取り付けていない場合はOFFへジャンパします。

1. コネクタを取り付ける（6個）

    下側に3個並んだコネクタは、最初に真ん中のコネクタを取り付けてから、左右のコネクタを取り付けます。

1. （オプション）ロータリーエンコーダを取り付ける

    ロータリーエンコーダは最大2個まで取り付けできます。

    - 左側グループ（RE_L1, RE_L2, RE_L3）のいずれかひとつ
    - 右側グループ（RE_R1, RE_R2）のどちらかひとつ

    おもて側からはめ込んで、うら側からはんだ付けします。  

    ノブも取り付けます。

1. （オプション）スタビライザーを取り付ける

    おもて側から、レイアウトに応じた場所へ取り付けます。  
    大きい方の穴へスタビライザーの突起を引っ掛け、小さい方の穴へパチンとはめます。  

1. スイッチを取り付ける

    おもて側からはめ込んで、うら側からはんだ付けします。  
    組み立てるレイアウトにより、一部の取り付け位置が変わります。

### 各基板をひとつに組み合わせる

1. 基板Midを基板Baseへ乗せ、ネジ穴へはめ込む。

1. 基板Baseのうら側から、基板Midのネジをナットで仮止めする。（全11箇所のうち、3箇所くらい）

    基板Mid  
    ↓  
    基板Base  
    ↑  
    ナット

1. 基板Midのケーブルを、基板Baseのコネクタへ差し込む。

1. ケーブルを基板と基板の隙間へ逃す（押し込む）。

1. 基板Topのケーブルを、基板Baseのコネクタへ差し込む。

    ケーブルは基板Midの穴を通します。

1. ケーブルを基板と基板の隙間へ逃しつつ、基板Topを基板Midへ乗せる。

1. 基板Topのおもて側から、基板Midを3mmネジで仮止めする。（全8箇所のうち、3箇所くらい）

    3mmネジ  
    ↓  
    基板Top  
    ↑  
    基板Mid  

### 動作確認と基板の完全固定

1. Remapの”Test Matrix Mode”を使用して、動作確認する

1. 動作確認できたら、仮止めしていた基板Base→Mid、基板Top→Midを、すべてネジどめして完全固定する

### ケースへ取り付け

1. ケースまたは専用ボトムプレートへ取り付ける

1. キーキャップを取り付ける

## サービスマニュアル

基板の準備やファームウェアの書き込みなど、出荷前の作業メモです。

<details>
<summary>《《《 詳しい説明 》》》</summary>

### パーツリスト

| 部品名 | 個数 | 備考 |
| :---- | :-----: | :---- |
| USBコネクタ<br>USB4085-GF-A | 1 ||
| ESD<br>PRTR5V0U2X | 1 | SMTAしなかった場合 |
| FUSE<br>0ZCJ0050AF2E | 1 | SMTAしなかった場合 |
| リセットスイッチ<br>RS-187R05A2-DSMTRT | 1 ||

### 基板セットアップ

作業対象はBase基板のみ

1. 部品取り付け

    1. 基板裏側からUSBコネクタを取り付ける

        テスターでピン接続、ショートしないことを確認する。
        ![USBコネクタ接続図](../assets/BuildGuide_v0_1/PCB_usb_wireing.png)  
        USBコネクタ接続図

    1. （オプション）基板裏側`D10`へESDを取り付ける

        基板に描かれた取り付け方向を参考

    1. （オプション）基板裏側`F1`へFUSEを取り付ける

        方向なし

    1. リセットスイッチを取り付ける

        方向なし

1. ファームウェア書き込み

    1. QMK Toolboxを起動して、書き込むファームウェアを開く

    1. 基板をPC/Macへ接続

      QMK Toolboxに、デバイスの接続メッセージが表示されることを確認。

    1. 基板のリセットスイッチを押す

      QMK Toolboxに、デバイスの切断と接続のメッセージが表示されることを確認。

    1. QMK Toolboxの`Flash`ボタンを押して書き込む

    1. Remapを開いて接続（自前のJSON読み込み） → EEPROMの初期化に1分ほどかかる

    1. Remapでキースイッチのスルーホールの反応を確認する

</details>
